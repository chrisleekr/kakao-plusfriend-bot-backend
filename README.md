# 커뮤니티봇 - 카카오톡 플러스 친구 챗봇

카카오 i 오픈빌더 (Kakao i Open Builder)를 이용한 플러스 친구 챗봇 (PHP + MySQL) 백엔드 프로젝트

## 프로젝트 안내

이 프로젝트는 샘플 테스트용으로 카카오톡 플러스 친구 챗봇을 구현하기 위해 만들어졌습니다. 이 프로젝트는 아주 기본 기능만을 구현하였습니다.

Production 환경에서는 사용하기에 부족함이 많으니 참고용으로만 사용하시기 바랍니다.

## Demo 예제

테스트 커뮤니티 챗봇: http://pf.kakao.com/_vAKtj
Backend API: https://kakao.chrislee.kr

## Production 예제

우리멜번 챗봇: https://pf.kakao.com/_EhWij

## 로컬 테스트 환경 구축

### Requirements

-   Docker/Docker-compose
-   HTTPie or Postman

```bash
$ git clone https://github.com/chrisleekr/kakao-plusfriend-bot-backend
$ docker-compose up -d
$ http GET localhost
```

## API 설치방법

1. 모든 소스 파일을 업로드합니다.
2. `~/public`폴더를 Document Root로 설정합니다.
3. `src/config.php.default`를 `src/config.php`로 변경 후 설정 값들을 알맞게 변경합니다.
4. `mysql-files/sql/init.sql` 파일을 데이터베이스에 Import 합니다.

## 카카오 i 오픈빌더 설정 방법

### 1. 준비사항

1. 카카오 플러스 친구를 만듭니다. `https://center-pf.kakao.com`

### 2. 카카오 챗봇 만들기

1. `https://i.kakao.com`에 로그인을 합니다.
2. `+` 아이콘을 눌러 새로운 봇을 추가합니다. i.e.) 커뮤니티봇
3. `설정` 메뉴로 이동하여 `플러스친구 계정 연결`에서 미리 만들어놓은 플러스친구 계정을 선택하여 연결시킵니다.

### 3. 스킬 만들기

1. `스킬` 메뉴로 이동하여 `생성` 버튼을 누릅니다.
2. `이름` 필드에 `백엔드 API`라고 입력합니다.
3. `기본 스킬로 설정`에 체크합니다.
4. `URL`과 `Test URL`에 API 주소를 넣습니다. i.e.) https://kakao.chrislee.kr
5. `저장` 버튼을 누릅니다.

### 4. 시나리오 만들기 - 공지사항 보기

1. `+` 버튼을 눌러 새로운 시나리오 `시나리오 01`를 추가합니다.
2. `시나리오 01`아래에 `+블록 추가` 버튼을 누릅니다.
3. 블록 이름에 `공지사항 보기`이라고 입력합니다.
4. `발화를 입력해주세요` 필드에 `공지`, `공지사항`을 입력하여 패턴을 추가하세요.
5. `파라미터 설정` 링크를 누르면 나오는 `스킬 선택`에서 `백엔드 API` 스킬을 선택합니다.
6. `응답 추가 0/3` 버튼을 눌러 `스킬데이터로 사용` 항목을 선택합니다.
7. `저장` 버튼을 누릅니다.

### 5. 웰컴 블록

1. `시나리오` 메뉴로 이동하여 `웰컴 블록`을 선택합니다.
2. `응답 추가 0/3` 버튼을 눌러 `카드형`을 선택합니다.
3. 이미지, 타이틀 과 텍스트를 입력합니다.
4. `버튼 추가`를 누르고, `버튼 설정`을 누릅니다.
5. 버튼명에 `최신 공지사항 보기`를 입력하고, 버튼 기능을 `블록연결`, `공지사항 보기`를 선택합니다.
6. 블록을 저장합니다.

### 6. 폴백 블록

1. `시나리오` 메뉴로 이동하여 `폴백 블록`을 선택합니다.
2. `파라미터 설정` 링크를 누르면 나오는 `스킬 선택`에서 `백엔드 API` 스킬을 선택합니다.
3. `응답 추가 1/3` 버튼을 눌러 `스킬데이터로 사용` 항목을 선택합니다.
4. `저장` 버튼을 누릅니다.

-   위와 같이 설정시, 발화에 해당되지 않은 글의 내용이 모두 스킬로 전송됩니다.

### 7. 배포하기

1. `배포` 메뉴로 이동하여 설명을 입력한다음에 `배포` 버튼을 누릅니다.

### 8. 테스트하기

1. 카카오톡으로 이동하여 봇을 검색하고 친구 추가를 합니다.
2. 커뮤니티 챗봇과 대화를 시도합니다.
3. 다음 검색어로 시도해보시기 바랍니다.

-   공지
-   Risus
